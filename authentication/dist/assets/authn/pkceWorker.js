self.addEventListener("message",async t=>{if(t.data.cmd!=="generatePkce")return;let e=new Uint8Array(96);crypto.getRandomValues(e);let a=btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),n=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(a)),o=btoa(String.fromCharCode(...new Uint8Array(n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),r=new Uint8Array(16);crypto.getRandomValues(r);let c=Array.from(r).map(s=>s.toString(16).padStart(2,"0")).join("");postMessage({codeVerifier:a,codeChallenge:o,state:c})});
